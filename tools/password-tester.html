<!DOCTYPE html>
<html lang="en" data-bs-theme="dark">
<head>
  <meta charset="utf-8">

  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="description" content="Local-only password tools: a cryptographically sound password generator and an entropy tester, built by Alex.">
  <meta name="author" content="Alex">
  <meta name="robots" content="index, follow">

  <title>Password Generator & Tester - CyberAlex</title>

  <!-- Canonical URL -->
  <link rel="canonical" href="https://www.cyberalex.uk/tools/password-tools.html">

  <!-- Open Graph -->
  <meta property="og:title" content="Password Generator & Tester - CyberAlex">
  <meta property="og:description" content="Generate cryptographically sound passwords and estimate their entropy locally in your browser.">
  <meta property="og:url" content="https://www.cyberalex.uk/tools/password-tools.html">
  <meta property="og:type" content="website">
  <meta property="og:site_name" content="CyberAlex">
  <meta property="og:image" content="https://www.cyberalex.uk/img/social-card.png">

  <!-- Twitter / X -->
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:title" content="Password Generator & Tester - CyberAlex">
  <meta name="twitter:description" content="Browser-based password generator and entropy tester that never sends your data anywhere.">
  <meta name="twitter:image" content="https://www.cyberalex.uk/img/social-card.png">

  <!-- Bootstrap 5 -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">

  <!-- Site styles -->
  <link rel="stylesheet" href="/css/main.css">

  <link rel="icon" href="/logo.png" type="image/png">

</head>

<body class="theme-dark">
  <!-- Skip link -->
  <a class="skip-link" href="#main-content">Skip to main content</a>

  <!-- Header injected by layout.js -->
  <header id="site-header" aria-label="Main site header"></header>

  <main id="main-content" class="container py-4" tabindex="-1">
    <!-- PAGE HEADER -->
    <section class="mb-4" aria-label="Page header">
      <nav aria-label="Breadcrumb" class="mb-2">
        <ol class="breadcrumb small mb-0">
          <li class="breadcrumb-item"><a href="/">Home</a></li>
          <li class="breadcrumb-item"><a href="/projects.html">Tools &amp; Projects</a></li>
          <li class="breadcrumb-item active" aria-current="page">Password Tools</li>
        </ol>
      </nav>

      <h1 class="h3 mb-1">Password Tools: Generator &amp; Entropy Tester</h1>
      <p class="text-secondary small mb-0">
        By <a href="/about.html">Alex</a> • Published: 4 April 2025 • Updated: 5 December 2025
      </p>
    </section>

    <!-- INTRO / SUMMARY -->
    <section class="mb-4">
      <div class="row g-4 align-items-start">
        <div class="col-lg-7">
          <p class="lead mb-3">
            Two small browser tools to help you create and assess strong passwords: a cryptographically sound
            password generator, and a local entropy tester that estimates how resistant a password is to brute force.
          </p>

          <p class="small text-secondary mb-3">
            The generator uses <code>crypto.getRandomValues()</code> to build passwords from configurable character
            sets, with options for easier typing or extra strength. The entropy tester applies a straightforward
            formula based on the character set and length to give an estimate in bits, alongside a simple
            “recommended / not recommended” judgement that lines up with the examples further down this page.
          </p>

          <p class="small text-secondary mb-3">
            Everything runs entirely in your browser: no passwords are transmitted or stored anywhere. These tools are
            designed to be simple, transparent helpers rather than full password managers, so you can see exactly how
            they behave, cross-check against the example table, and combine them with your own policies and threat model.
          </p>

          <p class="small text-secondary mb-0">
            You’ll also see why this site does <strong>not</strong> treat the popular
            <em>“three random words”</em> slogan as a magic solution. It was designed as
            <em>usable baseline advice for the general public</em>, but under realistic attack models a typical
            three-random-words password can sit in the region of ~60 bits of entropy – in our estimates, roughly
            “a couple of weeks” of cracking – which is nowhere near the “centuries” people often assume. The sections
            below walk through the numbers, recommendations, and finally how the randomness behind the generator itself
            is sanity-checked.
          </p>
        </div>

        <div class="col-lg-5">
          <div class="card h-100 card-raise">
            <div class="card-body small text-secondary">
              <h2 class="h6 text-uppercase text-muted mb-2">At a glance</h2>
              <ul class="mb-2">
                <li>Cryptographically sound password generator and entropy tester, both running locally.</li>
                <li>Slider-controlled password length up to 100 characters.</li>
                <li>Toggle for easier typing or extra-strong character sets.</li>
                <li>Entropy estimator with simple “recommended / not recommended” feedback.</li>
                <li>All processing is local to your browser; nothing is uploaded.</li>
                <li>Built-in randomness health check using the same API as the generator.</li>
              </ul>
              <p class="mb-0">
                You are responsible for how and where you store any generated passwords. Avoid re-using passwords
                across accounts and enable multi-factor authentication wherever possible.
              </p>
            </div>
          </div>
        </div>
      </div>
    </section>

    <!-- TOOLS -->
    <section class="mb-5" aria-labelledby="password-tools-heading">
      <h2 id="password-tools-heading" class="h4 mb-3">Interactive password tools</h2>

      <div class="row g-4">
        <!-- PASSWORD GENERATOR -->
        <div class="col-lg-6">
          <section class="pwtools mb-3" aria-label="Password generator">
            <div class="pwtools-container">
              <h3 class="h5 mb-2">Password Generator</h3>
              <p class="small text-secondary">
                Generate a random password locally in your browser. When you’re happy with it, you can send the result
                straight into the entropy tester on the right to see roughly how hard it is to brute force.
              </p>

              <div class="pwtools-card">
                <div class="pwtools-body">
                  <label for="lengthSlider" class="form-label small mb-1">
                    Password length:
                    <span id="lengthValue" class="fw-semibold">12 characters</span>
                  </label>
                  <input type="range"
                         class="form-range"
                         id="lengthSlider"
                         min="1"
                         max="100"
                         value="16"
                         aria-describedby="lengthHelp">
                  <div id="lengthHelp" class="form-text small text-secondary mb-3">
                    Higher is generally better, especially if you are pasting into a password manager.
                  </div>

                  <div class="form-check mb-1">
                    <input class="form-check-input" type="checkbox" id="easyTyping">
                    <label class="form-check-label small" for="easyTyping">
                      Extra easy typing (letters, numbers, and a dot)
                    </label>
                  </div>
                  <div class="form-check mb-3">
                    <input class="form-check-input" type="checkbox" id="extraStrength">
                    <label class="form-check-label small" for="extraStrength">
                      Extra strong (includes special and extended characters)
                    </label>
                  </div>

                  <button class="btn btn-primary w-100 mb-3" id="generateBtn" type="button">
                    Generate password
                  </button>

                  <div class="pwtools-output small">
                    <div class="mb-2">
                      <span class="text-muted d-block mb-1">Generated password</span>
                      <code class="password-output" id="passwordOutput">[password]</code>
                    </div>
                    <div class="d-flex flex-wrap gap-2">
                      <button class="btn btn-outline-light btn-sm flex-grow-1"
                              id="copyBtn"
                              type="button">
                        Copy to clipboard
                      </button>
                      <button class="btn btn-outline-secondary btn-sm flex-grow-1"
                              id="sendToTesterBtn"
                              type="button">
                        Send to entropy tester
                      </button>
                    </div>
                  </div>
                </div>
              </div>

              <p class="small text-secondary mt-3 mb-0">
                For most cases, aim for at least 16 characters. For passwords you never type (e.g. stored only in a
                password manager), much longer is better – and you can see that reflected in the entropy numbers you
                get from the tester and in the example table below.
              </p>
            </div>
          </section>
        </div>

        <!-- PASSWORD ENTROPY TESTER -->
        <div class="col-lg-6">
          <section class="pwtools mb-3" aria-label="Password entropy tester">
            <div class="pwtools-container">
              <h3 class="h5 mb-2">Password Entropy Estimator</h3>
              <p class="small text-secondary">
                Estimate the entropy of a password using a simple character-set × length formula. It’s the same model
                used in the “Illustrative examples” table further down, so you can compare your own passwords against
                the scenarios there.
              </p>

              <div class="pwtools-card">
                <div class="pwtools-body">
                  <label for="passwordInput" class="form-label small mb-1">
                    Password to test
                  </label>
                  <input type="password"
                         id="passwordInput"
                         class="form-control form-control-sm mb-2"
                         placeholder="Enter or paste a password"
                         autocomplete="off">
                  <div class="form-text small text-secondary mb-3">
                    This runs locally in your browser. Nothing is transmitted or stored.
                  </div>

                  <button id="calculateEntropy"
                          class="btn btn-primary w-100 mb-2"
                          type="button">
                    Calculate entropy
                  </button>
                  <p class="small text-secondary mb-3">
                    Minimum recommended entropy here is <strong>100 bits</strong> for high-value accounts – that’s
                    the “centuries” bracket in the table.
                  </p>

                  <div id="entropyResult" class="mt-2 small"></div>
                </div>
              </div>

              <p class="small text-secondary mt-3 mb-0">
                For a more advanced view, you can also compare results with tools like the
                <a href="https://bitwarden.com/password-strength/" class="link-light" target="_blank" rel="noopener">
                  Bitwarden password strength tester
                </a>. The idea is that all of these should roughly agree that high-value accounts deserve high-entropy,
                manager-generated passwords.
              </p>
            </div>
          </section>
        </div>
      </div>
    </section>



    <!-- CONTEXT & RECOMMENDATIONS -->
    <section class="mb-5" aria-labelledby="context-heading">
      <h2 id="context-heading" class="h4 mb-3">Context and recommendations</h2>

      <div class="row g-4">
        <div class="col-lg-7">
          <p class="small text-secondary">
            The generator and tester above give you numbers; this section is about what those numbers mean. Passwords
            are one of many forms of authentication, and one of the simplest ways to protect accounts and
            information. They are ultimately limited by time and compute power: given enough time (and poor settings),
            a password can be cracked by brute force. Increasing entropy – randomness and length – is how you push that
            time into the “not worth it” zone.
          </p>
          <p class="small text-secondary">
            Entropy is measured in bits and reflects how many possible combinations a given password could have.
            Roughly speaking, every extra bit doubles the search space. A small increase in length or character set
            can translate into a large increase in the time needed to exhaust all possibilities, which is why the
            example table jumps from seconds to years as you move down it.
          </p>
          <p class="small text-secondary mb-0">
            For high-value accounts or long-term secrets, aim for passwords that are randomly generated, unique to that
            service, and stored in a reputable password manager. For anything you have to type frequently – especially
            on mobile – you may prefer slightly easier character sets, but compensate with more length. The entropy
            tester is there to help you quantify those trade-offs.
          </p>
        </div>

        <div class="col-lg-5">
          <div class="card h-100 card-raise">
            <div class="card-body small text-secondary">
              <h3 class="h6 text-uppercase text-muted mb-2">Rules of thumb</h3>
              <ul class="mb-2">
                <li>Use unique passwords for every account.</li>
                <li>Use a password manager to generate and store long, random passwords.</li>
                <li>Aim for &gt;= 100 bits of entropy for high-value accounts.</li>
                <li>Avoid patterns, personal data, and common phrases.</li>
                <li>Enable multi-factor authentication wherever possible.</li>
              </ul>
              <p class="mb-0">
                For more detailed guidance, see standards such as NIST SP 800-63B/-63B-4 and the NCSC’s public
                guidance on passwords (including “three random words”) – but treat “three random words” as a
                <strong>minimum baseline</strong>, not an end goal. The examples below show why.
              </p>
            </div>
          </div>
        </div>
      </div>

      <!-- TABLE OF EXAMPLES -->
      <div class="mt-4">
        <h3 class="h5 mb-2">Illustrative examples (estimates)</h3>
        <p class="small text-secondary mb-2">
          The table below uses the same simple entropy model as the tester above
          (<code>log2(charsetSize) × length</code>) and a rough mapping
          to “time to crack”. These are illustrative, not guarantees, but they show how quickly entropy climbs – and
          why three random words land around the “weeks” range rather than “centuries”.
        </p>

        <div class="table-responsive small">
          <table class="table table-bordered table-striped mb-2">
            <thead class="table-dark">
              <tr>
                <th scope="col">Description</th>
                <th scope="col">Password</th>
                <th scope="col">Bits of Entropy</th>
                <th scope="col">Est. Time to Crack</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td>Most “<a href="https://en.wikipedia.org/wiki/Wikipedia:10,000_most_common_passwords" target="_blank" rel="noopener">common password</a>”</td>
                <td><code>123456</code></td>
                <td>19.93</td>
                <td>1 second</td>
              </tr>
              <tr>
                <td>A typical randomly generated 8-character password</td>
                <td><code>Nc.x90-X</code></td>
                <td>52.44</td>
                <td>3 hours</td>
              </tr>
              <tr>
                <td>Following the NCSC recommended “<a href="https://www.ncsc.gov.uk/collection/top-tips-for-staying-secure-online/three-random-words" target="_blank" rel="noopener">three random words</a>”</td>
                <td><code>poachrubycoma</code></td>
                <td>61.11</td>
                <td>14 days</td>
              </tr>
              <tr>
                <td>Following Forbes “<a href="https://www.forbes.com/advisor/business/how-create-strong-password/" target="_blank" rel="noopener">how to create a strong password</a>”</td>
                <td><code>G7&amp;d#4kzL1!</code></td>
                <td>72.10</td>
                <td>4 months</td>
              </tr>
              <tr>
                <td>Randomly generated 10-character password</td>
                <td><code>o95_/upw-%JJ</code></td>
                <td>78.66</td>
                <td>3 years</td>
              </tr>
              <tr>
                <td>Password with over 100 bits of entropy</td>
                <td><code>MfN&amp;q~WJqWzt4-\v</code></td>
                <td>104.87</td>
                <td>Centuries</td>
              </tr>
            </tbody>
          </table>
        </div>

        <p class="small text-secondary mb-0">
          The “three random words” example above sits around <strong>61 bits</strong> and an estimated
          <strong>~14 days</strong> in this simple model. In reality, attackers don’t brute-force every possible
          string; they use dedicated passphrase attack wordlists and tuned cracking rules. Knowing that many people
          follow the “three random words” pattern <em>shrinks the real search space further</em>, so offline cracking
          against a stolen hash can be significantly faster than these estimates suggest.
        </p>
      </div>

      <!-- PASSWORD RECOMMENDATIONS / 3RW CRITIQUE -->
      <div class="mt-4">
        <h3 class="h5 mb-2">Why “three random words” isn’t enough on its own</h3>
        <p class="small text-secondary">
          The NCSC’s original <em>three random words</em> advice was a huge step up from “Winter2024!” and recycled
          football-team-plus-number passwords. It gave non-technical users something they could actually remember,
          and for a lot of low-value accounts that’s still a huge improvement.
        </p>
        <p class="small text-secondary">
          But from a security-nerd perspective, it has hard limits. A typical three-word passphrase chosen from a
          relatively small dictionary and glued together in a predictable way (no spaces, no symbols, all lowercase)
          is exactly what modern cracking rigs are optimised for. Once an attacker has your password hash, they don’t
          blindly try “every 14-character string” – they throw tuned <em>passphrase</em> dictionaries and rules at it,
          targeting patterns like <code>wordwordword</code>. Under those conditions, what looks like “two weeks” in
          a model can be brought down to days or less.
        </p>
        <p class="small text-secondary">
          So on this site the rule of thumb is:
          <strong>treat three random words as a floor, not a target.</strong>
          It’s far better than weak, reused passwords – but for anything you truly care about, a long, random,
          manager-generated password with &gt;= 100 bits of entropy plus multi-factor authentication is the bar to aim
          for. Use three random words only where usability absolutely dominates and the risk is genuinely low.
        </p>

        <h3 class="h5 mt-4 mb-2">Password recommendations</h3>
        <p class="small text-secondary">
          Your circumstances and the security required will determine the entropy you really need. As a conservative
          default, aim for randomly generated passwords with at least <strong>100 bits of entropy</strong> for any
          account where compromise would hurt (financial, email, cloud storage, identity, etc.). You can use the
          generator and tester at the top of the page to reach that region.
        </p>
        <p class="small text-secondary">
          At a minimum, we’d recommend using a password manager (for example
          <a href="https://keepassxc.org/" class="link-light" target="_blank" rel="noopener">KeePassXC</a>) to
          generate and store unique, long passwords that combine upper and lowercase letters, numbers, and symbols.
          If you need to type the password on a phone or TV, you can trade some character-set complexity for extra
          length – but avoid “cute” constructions that fit obvious three-word patterns.
        </p>
        <p class="small text-secondary mb-0">
          To learn more about modern password thinking, see NIST’s Digital Identity Guidelines
          (<a href="https://pages.nist.gov/800-63-4/sp800-63b.html" class="link-light" target="_blank" rel="noopener">SP 800-63B-4</a>)
          and the NCSC’s password advice. Both now emphasise length, blocklists of known-bad passwords, and usability
          over old-school “must contain a symbol” rules.
        </p>
      </div>
    </section>

    <!-- RANDOMNESS, TRUST & BACKGROUND -->
    <section class="mb-5" aria-labelledby="randomness-background-heading">
      <h2 id="randomness-background-heading" class="h4 mb-3">Randomness, trust, and my background</h2>

      <div class="row g-4">
        <div class="col-lg-7">
          <p class="small text-secondary">
            All of the generator’s strength ultimately depends on one thing: the quality of the random numbers it
            uses. Under the hood, this page relies on <code>window.crypto.getRandomValues()</code>, which is the
            browser’s cryptographically secure random number generator (CSPRNG). Modern browsers are required to route
            this call to the operating system’s own CSPRNG (for example <code>/dev/urandom</code> on Unix-like systems
            or the appropriate Windows APIs), rather than weaker sources like <code>Math.random()</code>.
          </p>
          <p class="small text-secondary">
            I built this with a Computer Security background rather than just “I read somewhere this was secure”.
            I completed a BSc (Hons) in Computer Security, including modules such as:
          </p>
          <ul class="small text-secondary">
            <li>
              <strong>Secure Design, Testing and Programing</strong> – covering secure software design,
              Programing and testing, and critical thinking about how secure programs
              <em>actually</em> work.
            </li>
            <li>
              <strong>Mathematical Tools for Computer Security and Forensics</strong> – covering the mathematical
              side of security, including how to reason about randomness, distributions and proofs that underpin
              cryptographic primitives and forensic tools.
            </li>
            <li>
              <strong>Cyber Tools and Processes</strong> – covering use of Passware to break into 
              encrypted files and archives, giving me experience of how quickly weak or patterned passwords fall
              to wordlists with GPU backed machenes and how password cracking works in legal law enforcment scanarios.
            </li>
          </ul>
          <p class="small text-secondary mb-0">
            As part of building this page, I generated large samples from <code>crypto.getRandomValues()</code>
            in my own environment and ran basic statistical tests (frequency distribution, Shannon entropy, etc.).
            The outputs behaved as you would expect from a healthy CSPRNG – no obvious bias, entropy close to the
            theoretical maximum for the sample size. That doesn’t “prove” the CSPRNG is perfect, but it does give
            additional confidence that what the browser is exposing behaves like proper random data, and motivates
            the live health check in the next section.
          </p>
        </div>

        <div class="col-lg-5">
          <div class="card h-100 card-raise">
            <div class="card-body small text-secondary">
              <h3 class="h6 text-uppercase text-muted mb-2">Critical Evaluation</h3>
              <p class="mb-2">
                The live randomness sanity check below uses the <em>same</em> API as the password generator and runs
                simple tests on a fresh sample from <code>crypto.getRandomValues()</code>:
              </p>
              <ul class="mb-2">
                <li>Counts how often each byte (0–255) appears in the sample.</li>
                <li>Computes the approximate Shannon entropy of the distribution.</li>
                <li>Flags obviously strange behaviour (e.g. missing values, very low entropy).</li>
              </ul>
              <p class="mb-0">
                If your browser or environment were catastrophically broken, there’s a good chance this would look
                obviously wrong (very low entropy, severe bias, or repeated values). Subtle cryptographic weaknesses
                are <em>far</em> harder to detect and are outside the scope of a small page like this, but for normal
                users on mainstream browsers this should provide a sensible extra layer of transparency about the
                randomness feeding the generator.
              </p>
                <br>
              <p class="mb-0">
                These checks only detect obvious failures such as severe bias, low entropy or repeated values. It cannot
                uncover deeper cryptographic flaws, OS-level RNG issues, or targeted compromise. It also does not validate the
                security of your device, browser, extensions or network environment.
              </p>
            </div>
          </div>
        </div>
      </div>
    </section>

    <!-- Cryptographic Randomness Health Check TOOL -->
    <section class="mb-5" aria-labelledby="randomness-tool-heading">
      <h2 id="randomness-tool-heading" class="h4 mb-3">Cryptographic Randomness Health Check</h2>

      <div class="row g-4">
        <!-- LEFT: Cryptographic Randomness Health Check + result -->
        <div class="col-lg-7">
          <div class="pwtools">
            <div class="pwtools-container">
              <h3 class="h5 mb-2">
                Live test of <code>crypto.getRandomValues()</code>
              </h3>
              <p class="small text-secondary">
                This tool takes a fresh sample of random bytes from
                <code>crypto.getRandomValues()</code> – the same source used by the generator – runs a couple of basic
                statistical checks, and reports whether anything <em>obviously</em> wrong shows up.
              </p>

              <div class="pwtools-card">
                <div class="pwtools-body">
                  <p class="small mb-2">
                    When you load this page, it runs once automatically. You can re-run it below if you want to see
                    how different samples behave.
                  </p>
                  <button id="runRandomnessTestBtn"
                          class="btn btn-outline-light btn-sm mb-3"
                          type="button">
                    Re-run randomness checks
                  </button>

                  <div id="randomnessResult" class="small mb-2"></div>
                  <details class="small text-secondary" id="randomnessDetailsWrapper">
                    <summary>Show test details</summary>
                    <div id="randomnessDetails" class="mt-2"></div>
                  </details>
                </div>
              </div>

              <p class="small text-secondary mt-3 mb-0">
                If this test ever reports a serious issue, it could indicate a broken browser environment or a
                non-standard implementation. In that case, avoid relying on in-browser password generation and
                use a dedicated password manager instead.
              </p>
            </div>
          </div>
        </div>

        <!-- RIGHT: histogram chart -->
        <div class="col-lg-5">
          <div class="pwtools">
            <div class="pwtools-container">
              <h3 class="h6 text-uppercase text-muted mb-2">
                Histogram of observed values
              </h3>
              <p class="small text-secondary mb-2">
                Based on 1,000 random integers in the range 0–100, grouped into ten bins. For healthy randomness, the
                bars should be <em>roughly</em> level with each other – you’re looking for “nothing weird”, not a
                perfectly flat line.
              </p>

              <div class="pwtools-card">
                <div class="pwtools-body">
                  <div id="histogramBars" class="histogram-bars">
                    <div class="histogram-bar">
                      <div class="histogram-bar-inner"></div>
                      <span>0–10</span>
                    </div>
                    <div class="histogram-bar">
                      <div class="histogram-bar-inner"></div>
                      <span>11–20</span>
                    </div>
                    <div class="histogram-bar">
                      <div class="histogram-bar-inner"></div>
                      <span>21–30</span>
                    </div>
                    <div class="histogram-bar">
                      <div class="histogram-bar-inner"></div>
                      <span>31–40</span>
                    </div>
                    <div class="histogram-bar">
                      <div class="histogram-bar-inner"></div>
                      <span>41–50</span>
                    </div>
                    <div class="histogram-bar">
                      <div class="histogram-bar-inner"></div>
                      <span>51–60</span>
                    </div>
                    <div class="histogram-bar">
                      <div class="histogram-bar-inner"></div>
                      <span>61–70</span>
                    </div>
                    <div class="histogram-bar">
                      <div class="histogram-bar-inner"></div>
                      <span>71–80</span>
                    </div>
                    <div class="histogram-bar">
                      <div class="histogram-bar-inner"></div>
                      <span>81–90</span>
                    </div>
                    <div class="histogram-bar">
                      <div class="histogram-bar-inner"></div>
                      <span>91–100</span>
                    </div>
                  </div>
                  <p id="histogramSummary"
                     class="small text-secondary mt-3 mb-0"></p>
                </div>
              </div>

              <p class="small text-secondary mt-3 mb-0">
                If one bar is dramatically higher or lower than the others in repeated tests, that suggests bias and
                you should treat this environment with caution. On a typical modern browser you should see minor
                wobble between runs, but no persistent, glaring outliers.
              </p>
            </div>
          </div>
        </div>
      </div>
    </section>
    
    <section class="mb-4">
      <div class="pwtools-container">
        <p class="small mb-1">
          <span class="text-secondary">Share this tool:</span><br>
          <span class="text-secondary">https://www.</span>
          <a href="https://www.zilchy.link/password" class="link-light" id="shareLink">
            zilchy.link/password
          </a>
          <button class="btn btn-outline-light btn-sm ms-2" id="copyShareLinkBtn">Copy</button>
        </p>
        <p class="text-secondary small mb-0">
          Zilchy.link is my own open-source URL shortener. 
          It does not track or log users — the link simply redirects to this page.
        </p>
      </div>
    </section>


    <section>
      <div class="mt-4">
        <h3 class="h5 mb-2">Questions?</h3>
        <p class="small text-secondary mb-1">
          If you have feedback, ideas for improvements, want to sanity-check a password policy, or have any questions
          about how these tools work under the hood, feel free to get in touch.
        </p>
        <p class="small mb-0">
          <a href="/contact.html" class="link-light">Contact Alex</a>
        </p>
      </div>
    </section>

  </main>

  <footer id="site-footer"></footer>

  <!-- Scoped styles for the tools -->
  <style>
    .pwtools {
      margin-top: 0.75rem;
      margin-bottom: 1.5rem;
    }

    .pwtools-container {
      background: #101010;
      padding: 16px 18px;
      border-radius: 10px;
    }

    .pwtools-card {
      background: #111111;
      border: 1px solid #262626;
      border-radius: 8px;
    }

    .pwtools-body {
      padding: 12px 14px 14px;
    }

    .password-output {
      font-family: monospace;
      font-size: 1.1rem;
      word-break: break-all;
      padding: 4px 6px;
      border-radius: 4px;
      background: #181818;
      display: inline-block;
      min-height: 1.6em;
    }

    #entropyResult .alert,
    #randomnessResult .alert {
      margin-bottom: 0;
      padding: 8px 10px;
      font-size: 0.85rem;
    }

    @media (max-width: 576px) {
      .pwtools-container {
        padding: 14px;
      }
      .password-output {
        font-size: 1rem;
      }
    }

    .histogram-bars {
      display: flex;
      align-items: flex-end;
      gap: 6px;
      height: 160px;
      margin-top: 4px;
    }

    .histogram-bar {
      flex: 1;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: flex-end;
      height: 100%;
    }

    .histogram-bar-inner {
      width: 100%;
      border-radius: 4px 4px 0 0;
      background: #0d6efd; /* Bootstrap primary-ish */
      min-height: 6px;
      transition: height 0.25s ease-out;
    }

    .histogram-bar span {
      font-size: 0.7rem;
      margin-top: 4px;
      text-align: center;
      white-space: nowrap;
    }

    @media (max-width: 576px) {
      .histogram-bars {
        height: 130px;
      }
    }
  </style>

  <!-- JS: Bootstrap + layout + tool logic -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
  <script src="/js/layout.js"></script>

  <script>
    // --- PASSWORD GENERATOR LOGIC ---

    const lengthSlider = document.getElementById('lengthSlider');
    const lengthValue = document.getElementById('lengthValue');
    const passwordOutput = document.getElementById('passwordOutput');
    const copyBtn = document.getElementById('copyBtn');
    const sendToTesterBtn = document.getElementById('sendToTesterBtn');

    const easyTypingCheckbox = document.getElementById('easyTyping');
    const extraStrengthCheckbox = document.getElementById('extraStrength');

    function updateLengthLabel() {
      const length = parseInt(lengthSlider.value, 10);
      lengthValue.textContent = length + ' character' + (length === 1 ? '' : 's');
    }

    // Keep the two options mutually exclusive
    function toggleCheckbox(checkbox) {
      if (checkbox === easyTypingCheckbox && easyTypingCheckbox.checked) {
        extraStrengthCheckbox.checked = false;
      } else if (checkbox === extraStrengthCheckbox && extraStrengthCheckbox.checked) {
        easyTypingCheckbox.checked = false;
      }
    }

    easyTypingCheckbox.addEventListener('change', () => toggleCheckbox(easyTypingCheckbox));
    extraStrengthCheckbox.addEventListener('change', () => toggleCheckbox(extraStrengthCheckbox));

    lengthSlider.addEventListener('input', updateLengthLabel);
    updateLengthLabel(); // initial

    function generatePassword(length, easyTyping, extraStrength) {
      const lowerCase = 'abcdefghijklmnopqrstuvwxyz';
      const upperCase = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ';
      const numbers = '0123456789';
      const specialChars = '!@#$%^&*()_+[]{}|;:,.<>?';
      const foreignChars = 'áéíóúñçü';

      let characters = '';
      if (easyTyping) {
        characters += lowerCase + upperCase + numbers + '.';
      } else if (extraStrength) {
        characters += lowerCase + upperCase + numbers + specialChars + foreignChars;
      } else {
        characters += lowerCase + upperCase + numbers + specialChars;
      }

      if (!characters.length) {
        // Fallback just in case
        characters = lowerCase + upperCase + numbers + specialChars;
      }

      let password = '';
      const array = new Uint32Array(length);
      crypto.getRandomValues(array);
      for (let i = 0; i < length; i++) {
        const randomIndex = array[i] % characters.length;
        password += characters[randomIndex];
      }
      return password;
    }

    document.getElementById('generateBtn').addEventListener('click', () => {
      const length = parseInt(lengthSlider.value, 10);
      const easyTyping = easyTypingCheckbox.checked;
      const extraStrength = extraStrengthCheckbox.checked;

      const password = generatePassword(length, easyTyping, extraStrength);
      passwordOutput.textContent = password || '[password]';
    });

    copyBtn.addEventListener('click', async () => {
      const text = passwordOutput.textContent || '';
      if (!text || text === '[password]') return;

      try {
        await navigator.clipboard.writeText(text);
        const original = copyBtn.textContent;
        copyBtn.textContent = 'Copied';
        copyBtn.disabled = true;
        setTimeout(() => {
          copyBtn.textContent = original;
          copyBtn.disabled = false;
        }, 3000);
      } catch (err) {
        alert('Copy failed. You may need to copy manually.');
        console.error(err);
      }
    });

    // Send generated password into entropy tester
    sendToTesterBtn.addEventListener('click', () => {
      const text = passwordOutput.textContent || '';
      if (!text || text === '[password]') return;

      const input = document.getElementById('passwordInput');
      if (input) {
        input.value = text;
        if (typeof calculateEntropy === 'function') {
          calculateEntropy(); // auto-run the tester if available
        }
      }
    });

    // --- PASSWORD ENTROPY ESTIMATOR LOGIC ---

    const passwordInput = document.getElementById('passwordInput');
    const entropyResult = document.getElementById('entropyResult');
    const calculateBtn = document.getElementById('calculateEntropy');
    const histogramSummaryEl = document.getElementById('histogramSummary');

    function updateHistogramFromRandom() {
      const barInners = document.querySelectorAll('.histogram-bar-inner');
      const barLabels = document.querySelectorAll('.histogram-bar span');
      if (!barInners.length || !window.crypto || !window.crypto.getRandomValues) {
        return;
      }

      const binCount = 10;
      const bins = new Array(binCount).fill(0);
      const sampleCount = 1000;

      const buffer = new Uint32Array(sampleCount);
      crypto.getRandomValues(buffer);

      // Map 0..2^32-1 onto 0..100 and then into 10 bins
      for (let i = 0; i < sampleCount; i++) {
        const value = buffer[i] % 101; // 0–100 inclusive
        const idx = Math.min(binCount - 1, Math.floor(value / 10));
        bins[idx]++;
      }

      const maxBin = Math.max(...bins);
      const minBin = Math.min(...bins);
      const ideal = sampleCount / binCount;

      // Update bar heights
      barInners.forEach((bar, i) => {
        const h = maxBin ? (bins[i] / maxBin) * 100 : 0;
        bar.style.height = (h || 3) + '%';
        // Tooltip with exact count
        if (barLabels[i]) {
          barLabels[i].title = `${bins[i]} samples (ideal ≈ ${ideal.toFixed(1)})`;
        }
      });

      if (histogramSummaryEl) {
        const minRatio = minBin / ideal;
        const maxRatio = maxBin / ideal;
        const flatish = minRatio > 0.5 && maxRatio < 1.8;

        histogramSummaryEl.textContent = flatish
          ? `Counts ranged from ${minBin} to ${maxBin} (ideal per bin ≈ ${ideal.toFixed(1)}). For a 1,000-value sample this looks reasonably flat.`
          : `Counts ranged from ${minBin} to ${maxBin} (ideal per bin ≈ ${ideal.toFixed(1)}). That’s quite uneven; try re-running. If it stays like this, your environment may be biased.`;
      }
    }

    function analyzeEntropy(entropy) {
      if (entropy < 99.99) {
        return 'Not recommended (entropy below 100 bits). Consider a longer and/or more complex password.';
      } else {
        return 'Recommended (meets the 100-bit entropy guideline used on this site).';
      }
    }

    function calculateEntropy() {
      const password = (passwordInput.value || '').trim();

      if (password === '') {
        entropyResult.innerHTML =
          '<div class="alert alert-danger" role="alert">Please enter a password to test.</div>';
        return;
      }

      let charsetSize = 0;
      if (/[a-z]/.test(password)) charsetSize += 26;       // Lowercase
      if (/[A-Z]/.test(password)) charsetSize += 26;       // Uppercase
      if (/[0-9]/.test(password)) charsetSize += 10;       // Numbers
      if (/[\W_]/.test(password)) charsetSize += 32;       // Special characters
      if (/[\x80-\xFF]/.test(password)) charsetSize += 128; // Extended ASCII

      if (!charsetSize) {
        entropyResult.innerHTML =
          '<div class="alert alert-warning" role="alert">Could not detect a valid character set for this password.</div>';
        return;
      }

      const entropy = Math.log2(charsetSize) * password.length;

      entropyResult.innerHTML = `
        <div class="alert alert-info" role="status">
          <strong>Entropy:</strong> ${entropy.toFixed(2)} bits<br>
          <strong>Analysis:</strong> ${analyzeEntropy(entropy)}
        </div>
      `;
    }

    calculateBtn.addEventListener('click', calculateEntropy);

    passwordInput.addEventListener('keydown', (event) => {
      if (event.key === 'Enter') {
        event.preventDefault();
        calculateEntropy();
      }
    });

    // --- RANDOMNESS SANITY CHECK LOGIC ---

    const randomnessResultEl = document.getElementById('randomnessResult');
    const randomnessDetailsEl = document.getElementById('randomnessDetails');
    const runRandomnessTestBtn = document.getElementById('runRandomnessTestBtn');

    function formatNumber(num, decimals) {
      return num.toFixed(decimals);
    }

    function runRandomnessSanityCheck(autoRun = false) {
      if (!window.crypto || !window.crypto.getRandomValues) {
        randomnessResultEl.innerHTML =
          '<div class="alert alert-danger" role="alert">Your browser does not provide crypto.getRandomValues(). This tool cannot run a randomness test, and the generator should not be used here.</div>';
        randomnessDetailsEl.textContent = '';
        return;
      }

      const sampleSize = 8192; // bytes
      const bytes = new Uint8Array(sampleSize);
      crypto.getRandomValues(bytes);

      const counts = new Array(256).fill(0);
      for (let i = 0; i < sampleSize; i++) {
        counts[bytes[i]]++;
      }

      let entropy = 0;
      let minCount = sampleSize;
      let maxCount = 0;
      let zeroValues = 0;

      for (let i = 0; i < 256; i++) {
        const c = counts[i];
        if (c === 0) {
          zeroValues++;
          continue;
        }
        const p = c / sampleSize;
        entropy -= p * Math.log2(p);
        if (c < minCount) minCount = c;
        if (c > maxCount) maxCount = c;
      }

      const expected = sampleSize / 256; // ~32
      const minRatio = minCount / expected;
      const maxRatio = maxCount / expected;

      // Simple heuristics for "obviously broken"
      const looksReasonable =
        entropy > 7.5 && entropy <= 8.1 &&
        zeroValues === 0 &&
        minRatio > 0.1 && maxRatio < 3.5;

      if (looksReasonable) {
        randomnessResultEl.innerHTML =
          '<div class="alert alert-info" role="status"><strong>Result:</strong> No obvious problems detected. This sample looks consistent with healthy random output for this basic test.</div>';
      } else {
        randomnessResultEl.innerHTML =
          '<div class="alert alert-warning" role="alert"><strong>Warning:</strong> This sample looks unusual for random data in this simple test. It may just be chance, but if this persists across multiple runs you should avoid relying on in-browser password generation on this device.</div>';
      }

      randomnessDetailsEl.innerHTML = `
        <p>Sample size: <strong>${sampleSize}</strong> bytes</p>
        <ul>
          <li>Approximate Shannon entropy: <strong>${formatNumber(entropy, 3)}</strong> bits (max is 8.000 per byte)</li>
          <li>Expected count per byte value: ~<strong>${formatNumber(expected, 2)}</strong></li>
          <li>Observed minimum count: <strong>${minCount}</strong> (~${formatNumber(minRatio, 2)} × expected)</li>
          <li>Observed maximum count: <strong>${maxCount}</strong> (~${formatNumber(maxRatio, 2)} × expected)</li>
          <li>Byte values not seen at all in this sample: <strong>${zeroValues}</strong></li>
        </ul>
        <p class="mb-0">
          Note: This is only a coarse sanity check, not a full statistical test suite. Even “good” CSPRNG output will
          occasionally produce slightly odd-looking samples; what you’re looking for are <em>consistent</em> serious
          anomalies over many runs.
        </p>
      `;
      // Update the histogram with a fresh 0–100 sample
      updateHistogramFromRandom();
    }

    if (runRandomnessTestBtn) {
      runRandomnessTestBtn.addEventListener('click', () => runRandomnessSanityCheck(false));
    }

    // Run once automatically when the page loads
    runRandomnessSanityCheck(true);

    // Add js for copy share button 
    const shareURL = "https://www.zilchy.link/password";
    const copyShareLinkBtn = document.getElementById("copyShareLinkBtn");
    const shareLink = document.getElementById("shareLink");
    
    copyShareLinkBtn.addEventListener('click', async () => {
      try {
        await navigator.clipboard.writeText(shareURL);
        const original = copyShareLinkBtn.textContent;
        copyShareLinkBtn.textContent = "Copied!";
        shareLink.classList.add("fw-bold");
    
        setTimeout(() => {
          copyShareLinkBtn.textContent = original;
          shareLink.classList.remove("fw-bold");
        }, 2000);
      } catch (err) {
        console.error(err);
      }
    });

  </script>
</body>
</html>
